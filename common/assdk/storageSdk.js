"use strict";function init(){function e(e,a){var r=n.getUserInfo(),t=r?r.openid:"guest";return g.join(c,e+"_"+a+"_"+t+".data.json")}function a(a,r,t){var o=e(a,r);s.writeFileSync(o,JSON.stringify(t),"utf8")}function r(r,t){var o=e(r,t),i=void 0;try{i=JSON.parse(s.readFileSync(o,"utf8"))}catch(g){i={},a(r,t,i)}return i}function t(e,a){var t=e.appid,o=e.appname,i=r(t,o),s=e.args,g=s.key,n=i[g],p=void 0;p=void 0!==n?{errMsg:"getStorage:ok",data:n.data,dataType:n.dataType}:{errMsg:"getStorage:fail"},a(p)}function o(e,t){var o=e.appid,i=e.appname,s=r(o,i),g=e.args,n=g.key,d=g.data,c=g.dataType;s[n]={data:d,dataType:c};var u=p.getProjectConfig({hash:e.apphash}),f=u?u.Setting.MaxLocalstorageSize:S;JSON.stringify(s).length>1024*f*1024?t({errMsg:"setStorage:fail;exceed storage max size "+f+"Mb;"},{appid:o,storage:r(o,i)}):(a(o,i,s),t({errMsg:"setStorage:ok"},{appid:o,storage:s}))}function i(e,r){var t=e.appid,o=e.appname;a(t,o,{}),r({errMsg:"clearStorage:ok"},{appid:i,storage:{}})}var s=require("fs"),g=require("path"),n=require("../../stores/windowStores.js"),p=require("../../stores/projectStores.js"),d=require("../../config/dirConfig.js"),S=10,c=d.WeappStorage;_exports={getStorage:t,clearStorage:i,setStorage:o,getStorageSync:t,setStorageSync:o,clearStorageSync:i}}var _exports;init(),module.exports=_exports;